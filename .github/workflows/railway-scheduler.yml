name: Railway App Scheduler

on:
  schedule:
    # Gi·ªù UTC = VN -7
    - cron: "0 0 * * *"      # 07:00 s√°ng VN b·∫≠t app
    - cron: "30 14 * * *"    # 21:30 t·ªëi VN t·∫Øt app
  workflow_dispatch:

jobs:
  control-app:
    runs-on: ubuntu-latest
    steps:
      - name: Wake up app at 7:00
        if: github.event.schedule == '0 0 * * *'
        run: |
          echo "üîπ B·∫≠t app Railway"
          curl -X POST "https://backboard.railway.app/graphql/v2" \
          -H "Authorization: Bearer ${{ secrets.RAILWAY_TOKEN }}" \
          -H "Content-Type: application/json" \
          -d '{"query":"mutation { projectDeploy(input: { projectId: \"3826dccf-6cf2-4755-8d34-4fe7a957e0c3" }) { id } }"}'

      - name: Stop app at 21:30
        if: github.event.schedule == '30 14 * * *'
        run: |
          echo "üî∏ D·ª´ng app Railway"
          curl -X POST "https://backboard.railway.app/graphql/v2" \
          -H "Authorization: Bearer ${{ secrets.RAILWAY_TOKEN }}" \
          -H "Content-Type: application/json" \
          -d '{"query":"mutation { serviceDelete(input: { serviceId: \"d3362d88-1c5b-4e7f-a0f7-cd5dc90c5ce3" }) { id } }"}'
